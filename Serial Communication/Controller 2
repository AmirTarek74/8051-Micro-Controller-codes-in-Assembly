ORG 00H
	
	MOV TMOD, #20H
	MOV TH1, #-3
	MOV SCON, #50H
	SETB TR1
	MOV P1,#0FFH
	AGAIN:
	MOV R5,#0
	MOV R6,#0
	
	HERE: JNB RI, HERE
	MOV A, SBUF
	CLR RI
	MOV R0,A
	MOV A, #59H
	MOV SBUF,A
	HERE02: JNB TI, HERE02
	CLR TI
	;OPERATION
	HERE1: JNB RI, HERE1
	MOV A, SBUF
	CLR RI
	MOV R3,A
	MOV A, #59H
	MOV SBUF,A
	HERE12: JNB TI, HERE12
	CLR TI
	
	;OPERATION
	HERE33: JNB RI, HERE33
	MOV A, SBUF
	CLR RI
	MOV R2,A
	MOV A, #59H
	MOV SBUF,A
	HERE32: JNB TI, HERE32
	CLR TI
;	
	HERE22: JNB RI, HERE22
	CLR RI
	MOV A,#59H
	MOV SBUF,A
	HERE23: JNB TI, HERE23
	CLR TI
	
	CJNE R3,#2DH, NOTSUB
	SJMP SUB
	NOTSUB: CJNE R3,#2FH, NOTDIV
	SJMP DIVV
	NOTDIV: CJNE R3,#2AH, NOTMUL
	SJMP MULT
	NOTMUL: SJMP ADDD
	
	ADDD:MOV A,R0
		 ADD A,R2
		 MOV R6,A
		 MOV P1,A
		 SJMP SENDRESULT
		 
	MULT:MOV A,R0
		 MOV B,R2
		 MUL AB
		 MOV R6,A
		 SJMP SENDRESULT
		 
	SUB:MOV A,R0
		CLR C
		SUBB A,R2
		MOV R6,A
		JNC SENDRESULT
		CPL A
		INC A
		MOV P1,A
		MOV R6,A
		SJMP SENDNEG
	
	DIVV:MOV A,R0
		 MOV B,R2
		 DIV AB
		 MOV R6,A
		 MOV R5,B
		 CJNE R5,#0,SENDDECIMAL
		 SJMP SENDRESULT
	
	SENDRESULT:MOV A,R6
		MOV SBUF,A
		HERE2: JNB TI,HERE2
		CLR TI
		WAIT: JNB RI,WAIT
		CLR RI
		MOV A, SBUF
		CJNE A, #59H, SENDRESULT
		LJMP AGAIN
	
	SENDNEG: MOV A,#'M'
		MOV SBUF,A
		HERE3: JNB TI,HERE3
		CLR TI
		WAIT2: JNB RI,WAIT2
		CLR RI
		MOV A, SBUF
		CJNE A, #59H, SENDNEG
		SENDVAL: MOV A,R6
		MOV SBUF,A
		HERE4: JNB TI,HERE4
		CLR TI
		WAIT3: JNB RI,WAIT3
		CLR RI
		MOV A, SBUF
		CJNE A, #59H, SENDVAL
		LJMP AGAIN
		
	SENDDECIMAL: MOV A,#'D'
		MOV SBUF,A
		HERE8: JNB TI,HERE8
		CLR TI
		WAIT14: JNB RI,WAIT14
		CLR RI	
;		MOV A, SBUF
;		CJNE A, #59H, SENDDECIMAL
		SENDVAL1:MOV A,R6
		MOV SBUF,A
		HERE6: JNB TI,HERE6
		CLR TI
		WAIT4: JNB RI,WAIT4
		CLR RI
;		MOV A, SBUF
;		CJNE A, #59H, SENDVAL1
		SENDVAL2: MOV A,R5
		MOV B,#10
		MUL AB
		MOV B,R2
		DIV AB
		MOV SBUF,A
		HERE5: JNB TI,HERE5
		CLR TI
		WAIT7: JNB RI,WAIT7
		CLR RI
;		MOV A, SBUF
;		CJNE A, #59H, SENDVAL2
		LJMP AGAIN
	END
